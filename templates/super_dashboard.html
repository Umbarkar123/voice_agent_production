{% extends "layout.html" %}
{% block content %}

<div class="page-header">
    <h1>Super Admin Control Panel</h1>
    <p>Monitor all clients, users, calls and complete system analytics</p>
</div>

<!-- ================= KPI SECTION ================= -->
<div class="kpi-container">

    <div class="kpi">
        <h3>Total Clients</h3>
        <p>{{ total_clients }}</p>
    </div>

    <div class="kpi">
        <h3>Total Users</h3>
        <p>{{ total_users }}</p>
    </div>

    <div class="kpi">
        <h3>Total Calls</h3>
        <p>{{ total_calls }}</p>
    </div>

    <div class="kpi">
        <h3>Pending Calls</h3>
        <p>{{ pending_calls }}</p>
    </div>

    <div class="kpi">
        <h3>Approved Calls</h3>
        <p>{{ approved_calls }}</p>
    </div>

    <div class="kpi">
        <h3>Active Clients</h3>
        <p>{{ active_clients }}</p>
    </div>

</div>

<!-- ================= CLIENT ANALYTICS ================= -->
<div style="margin-top:30px;" class="card full">

    <div class="card-header">
        <h2>Client Analytics</h2>
    </div>

    <table class="calls-table">
        <thead>
            <tr>
                <th>Company</th>
                <th>Email</th>
                <th>Total Calls</th>
                <th>Pending</th>
                <th>Approved</th>
                <th>Last Activity</th>
            </tr>
        </thead>

        <tbody>
        {% for c in clients %}
            <tr>
                <td>{{ c.company }}</td>
                <td>{{ c.email }}</td>
                <td>{{ c.total }}</td>
                <td>{{ c.pending }}</td>
                <td>{{ c.approved }}</td>
                <td>{{ c.last_activity }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<!-- ================= RECENT CALLS ================= -->
<div style="margin-top:30px;" class="card full">

    <div class="card-header">
        <h2>All Recent Calls (System Wide)</h2>
    </div>

    <table class="calls-table">
        <thead>
            <tr>
                <th>Customer</th>
                <th>Phone</th>
                <th>Business</th>
                <th>Service</th>
                <th>Status</th>
                <th>Date</th>
                <th>Action</th>
            </tr>
        </thead>

        <tbody>
        {% for call in recent %}
            <tr>
                <td>{{ call.name }}</td>
                <td>{{ call.phone }}</td>
                <td>{{ call.business }}</td>
                <td>{{ call.service }}</td>
                <td>
                    <span class="badge {{ call.status|lower }}">
                        {{ call.status }}
                    </span>
                </td>
                <td>{{ call.createdAt }}</td>
                <td>
                    <a href="/call/{{ call._id }}" class="btn-view">Open</a>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
